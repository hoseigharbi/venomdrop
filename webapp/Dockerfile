FROM node:18-slim

WORKDIR /app

# Arguments
ARG VITE_API_BASE_URL
ARG VITE_VENOM_NETWORK
ARG VITE_VENOMSCAN_BASE_URL
ARG VITE_VENOMDROP_COLLECTION_FACTORY_ADDRESS

# Environment Variables for Build
ENV VITE_API_BASE_URL ${VITE_API_BASE_URL}
ENV VITE_VENOM_NETWORK ${VITE_VENOM_NETWORK}
ENV VITE_VENOMSCAN_BASE_URL ${VITE_VENOMSCAN_BASE_URL}
ENV VITE_VENOMDROP_COLLECTION_FACTORY_ADDRESS ${VITE_VENOMDROP_COLLECTION_FACTORY_ADDRESS}

# Setup a path for using local npm packages
RUN mkdir -p /opt/node_modules

COPY ./package.json /app
COPY ./package-lock.json /app

RUN npm i

COPY ./ /app

RUN npm run build

EXPOSE 5173

CMD ["npm", "start"]
